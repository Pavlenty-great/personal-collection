<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book: {{ book.book_name }}</title>
    <link rel="stylesheet" href="{% static 'css/book_detail.css' %}">
</head>
<body class="book-detail-body">
    <!-- –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ -->
    <a href="{% url 'index' %}" class="back-link">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</a>
    
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫–Ω–∏–≥–µ -->
    <div class="header">
        <h1 class="book-title">"{{ book.book_name }}"</h1>
        <div class="book-meta">
            <strong>–ê–≤—Ç–æ—Ä:</strong> {{ book.authors_list }}<br>
            <strong>–ì–æ–¥ –∏–∑–¥–∞–Ω–∏—è:</strong> {{ book.book_year }}<br>
            <strong>–ú–µ—Å—Ç–æ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏:</strong> {{ book.place_name }}
        </div>
    </div>
    
    <!-- –°–µ–∫—Ü–∏—è –∑–∞–º–µ—Ç–æ–∫ -->
    <div class="notes-section">
        <!-- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–º–µ—Ç–æ–∫ -->
        <div class="notes-view-section">
            <h2 class="section-title">–ó–∞–º–µ—Ç–∫–∏ –∫ –∫–Ω–∏–≥–µ ({{ notes|length }}):</h2>
            
            <!-- –§–æ—Ä–º–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–º–µ—Ç–æ–∫ -->
            <form id="deleteNotesForm" method="POST" action="{% url 'delete_notes' book.book_id %}">
                {% csrf_token %}
                
                <div class="notes-list">
                    {% if notes %}
                        {% for note in notes %}
                        <div class="note-item">
                            <input 
                                type="checkbox" 
                                class="note-checkbox"
                                name="note_ids" 
                                value="{{ note.note_id }}"
                                id="note_{{ note.note_id }}"
                            >
                            <div class="note-item-content">
                                <div class="note-item-header">
                                    <span class="note-type">{{ note.note_type }}</span>
                                </div>
                                <div class="note-text">{{ note.note_text }}</div>
                                <div class="note-date">
                                    {{ note.date_created|date:"d.m.Y H:i" }}
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                        
                        <!-- –ü–∞–Ω–µ–ª—å –≤—ã–±–æ—Ä–∞ –∑–∞–º–µ—Ç–æ–∫ -->
                        <div class="note-selection-panel">
                            <label class="note-select-all-label">
                                <input 
                                    type="checkbox" 
                                    id="selectAllNotes"
                                    style="margin-right: 8px;"
                                >
                                –í—ã–±—Ä–∞—Ç—å –≤—Å–µ –∑–∞–º–µ—Ç–∫–∏
                            </label>
                            
                            <button 
                                type="submit" 
                                id="deleteSelectedNotesBtn"
                                class="note-delete-button"
                            >
                                –£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ
                            </button>
                        </div>
                        
                    {% else %}
                        <div class="empty-notes">
                            üìù –ü–æ–∫–∞ –Ω–µ—Ç –∑–∞–º–µ—Ç–æ–∫. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é!
                        </div>
                    {% endif %}
                </div>
            </form>
        </div>
        
        <!-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∑–∞–º–µ—Ç–∫–∏ -->
        <div class="notes-add-section">
            <h2 class="section-title">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É</h2>
            <div class="notes-add">
                <form method="POST" action="{% url 'add_note' book.book_id %}">
                    {% csrf_token %}
                    
                    <div class="form-group">
                        <label for="note_type_id" class="note-label">–¢–∏–ø –∑–∞–º–µ—Ç–∫–∏:</label>
                        <select id="note_type_id" name="note_type_id" class="note-select" required>
                            <option value="1">–û–±—â–∞—è –∑–∞–º–µ—Ç–∫–∞</option>
                            <option value="2">–¶–∏—Ç–∞—Ç–∞</option>
                            <option value="3">–†–µ—Ü–µ–Ω–∑–∏—è</option>
                            <option value="4">–ê–Ω–∞–ª–∏–∑</option>
                            <option value="5">–í–æ–ø—Ä–æ—Å—ã –ø–æ —Ç–µ–∫—Å—Ç—É</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="note_text" class="note-label">–¢–µ–∫—Å—Ç –∑–∞–º–µ—Ç–∫–∏:</label>
                        <textarea id="note_text" name="note_text" class="note-textarea"
                                  placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∑–∞–º–µ—Ç–∫–∏..." required></textarea>
                    </div>
                    
                    <button type="submit" class="btn">üìù –î–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É</button>
                </form>
            </div>
        </div>
    </div>
    
    <!-- –°–æ–æ–±—â–µ–Ω–∏—è Django -->
    {% if messages %}
    <div class="messages">
        {% for message in messages %}
        <div class="message {{ message.tags }}">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <script src="{% static 'js/notes.js' %}"></script>
</body>
</html>